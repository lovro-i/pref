# [PREF](../README.md)
### Preference Data Mining Java Library

## 2. Getting Started

Everything starts by creatings an `ItemSet` - the set of items (elements, alternatives) that we make preference over. If in our applications users state their preference over movies, this set represents 20 movies:
```java
ItemSet items = new ItemSet(20); // creates a set of 20 items, with IDs 0..19
```

You can get an Item from the set by its id:
```java
Item item = items.getItemById(2);
```

You can assign a tag to an item. It can be any object it represents, or its name, or whatever you want:
```java
item.setTag("Twelve Monkeys");
```

You can also use convenience methods for naming items, starting with `.tag...()`:
```java
items.tagSigmas(); // Items will be named s1, s2, s3... (one-based)
items.tagLetters(); // Change item names to A, B, C...
```

Class `Ranking` represents a ranking (complete or incomplete) of items:

```java
Ranking ranking = new Ranking(items); // create an empty ranking
ranking.add(items.getItemById(3));
ranking.add(items.getItemByTag("E"));
ranking.add(items.get(0)); // same as .getItemById()
```

Or, you can get the reference ranking (complete ranking with items in order by their ids), or a random ranking directly from the `ItemSet`:

```java
Ranking referenceRanking = items.getReferenceRanking();
Ranking randomRanking = items.getRandomRanking();
```

`Ranking` implements `PreferenceSet` interface. However, there are other types of preference sets that implement `PreferenceSet` interface. If we want to specify pairwise preferences, such as { A > B, A > D, C > D } (that cannot be represented by a ranking), we can use `MapPreferenceSet`:

```java
MapPreferenceSet pref = new MapPreferenceSet(items);
pref.add(items.get(0), items.get(1));
pref.add(items.getItemByTag("A"), items.getItemByTag("D"));
pref.addByTag("C", "D");
```

`Sample` is a (weighted or unweighted) set of `PreferenceSets`:

```java
Sample<PreferenceSet> sample = new Sample<PreferenceSet>(items);
sample.add(ranking);
sample.add(randomRanking);
```

Now the sample has two rankings in it.


## 3. Mallows Model

Mallows model is an instance-based ranking model, which is a kind of Gaussian distribution for rankings, at least by its ubiquity in the world of preferences. It has two parameters: central ranking (s) and spread (?).


You can create a Mallows model object:
```java
MallowsModel model = new MallowsModel(items.getRandomRanking(), 0.3d);
```

And easily sample 5000 rankings from it:
```java
Sample<Ranking> mallowsSample = MallowsUtils.sample(model, 5000);
```

## 4. Reconstructing Mallows Model

If we have a sample of complete rankings, we can fit Mallows model (find the central ranking and spread) using `CompleteReconstructor`:

```java
MallowsReconstructor reconstructor = new CompleteReconstructor();
MallowsModel model = reconstructor.reconstruct(sample);
```

In case we have a sample of incomplete rankings or other preference sets, we have to use EM method to fit Mallows model. There are several different implementations, but you may want to go with `AMPxSReconstructor`:

```java
MallowsReconstructor reconstructor = new AMPxSReconstructor();
MallowsModel model = reconstructor.reconstruct(sample);
```

## 5. Mixture of Mallows

Mixture of Mallows is a weighted set of Mallows models. It is represented by class `MallowsMixtureModel`.

```java
ItemSet items = new ItemSet(10);
MallowsModel model1 = new MallowsModel(items.getReferenceRanking(), 0.2);
MallowsModel model2 = new MallowsModel(items.getRandomRanking(), 0.5);
 
MallowsMixtureModel mix = new MallowsMixtureModel(items);
mix.add(model1, 0.3);
mix.add(model2, 0.7);
```

We can also reconstruct a mixture of Mallows model from a sample of preference sets that belong to different Mallows models. We first use Affinity Propagation to separate users into clusters, and then fit Mallows models over each of these clusters.

```java
// Cluster the sample
PreferenceClusterer clusterer = new PreferenceClusterer(10); // no more than 10 clusters, may be less
PreferenceClusters clusters = clusterer.cluster(sample);

// Fit Mallows models over each of the clusters
MallowsMixtureReconstructor reconstructor = new AMPxSMixtureReconstructor();
MallowsMixtureModel model = reconstructor.model(clusters);
```

## 6. Other